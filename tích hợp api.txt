Ch√†o b·∫°n,Chu·∫©n r·ªìi! Vi·ªác b·∫°n nh·∫≠n ra s·ª± kh√°c bi·ªát n√†y l√† m·∫•u ch·ªët c·ªßa t√≠ch h·ª£p. Nh∆∞ ch√∫ng ta ƒë√£ th·∫£o lu·∫≠n, gi·∫£i ph√°p t·ªëi ∆∞u nh·∫•t (√≠t s·ª≠a code nh·∫•t v√† an to√†n nh·∫•t) l√† √°p d·ª•ng "L·ªõp Phi√™n D·ªãch" (Adapter Pattern) ·ªü Frontend.ƒê√¢y l√† t√†i li·ªáu h∆∞·ªõng d·∫´n k·ªπ thu·∫≠t chi ti·∫øt ƒë·ªÉ th·ª±c hi·ªán gi·∫£i ph√°p n√†y.üìÑ T√†i li·ªáu: T√≠ch h·ª£p API H·ªçc b·ªïng (Optimal Adapter Pattern)1. M·ª•c ti√™uT√†i li·ªáu n√†y h∆∞·ªõng d·∫´n c√°ch "phi√™n d·ªãch" d·ªØ li·ªáu tr·∫£ v·ªÅ t·ª´ scholarship-service (Backend) sang c·∫•u tr√∫c d·ªØ li·ªáu m√† React Components (Frontend) mong ƒë·ª£i.M·ª•c ti√™u l√† ch·ªâ s·ª≠a 1 file duy nh·∫•t ·ªü Frontend (src/services/scholarship.service.ts) m√† kh√¥ng c·∫ßn thay ƒë·ªïi b·∫•t k·ª≥ Component React hay API Backend n√†o.2. Ph√¢n t√≠ch V·∫•n ƒë·ªÅ: T√™n tr∆∞·ªùng kh√¥ng kh·ªõpƒê√¢y l√† b·∫£ng so s√°nh m√¢u thu·∫´n gi·ªØa Backend (DB) v√† Frontend (React) m√† ch√∫ng ta c·∫ßn "phi√™n d·ªãch":T√™n tr∆∞·ªùng Backend (DB/API)T√™n tr∆∞·ªùng Frontend (React)V√≠ d·ª• BackendV√≠ d·ª• Frontend mong mu·ªënscholarshipAmountamount50000.0050000leveltype"UNDERGRADUATE""UNDERGRADUATE" (d√πng chung)moderationStatusstatus"APPROVED""PUBLISHED" (ho·∫∑c "APPROVED")studyModeisRemote"REMOTE"truefullDescriptiondescription"Long text...""Long text..."creatorUserIdproviderId123"123" (string)viewsCntviewCount1251253. Gi·∫£i ph√°p T·ªëi ∆∞u: C·∫≠p nh·∫≠t L·ªõp Service (Adapter)Ch√∫ng ta s·∫Ω t·∫≠p trung to√†n b·ªô logic "phi√™n d·ªãch" v√†o file src/services/scholarship.service.ts.Ch√∫ng ta s·∫Ω t·∫°o m·ªôt h√†m helper ri√™ng g·ªçi l√† _transformOpportunity ƒë·ªÉ "d·ªãch" m·ªôt ƒë·ªëi t∆∞·ª£ng h·ªçc b·ªïng. Sau ƒë√≥, ch√∫ng ta s·∫Ω d√πng h√†m n√†y trong m·ªçi h√†m g·ªçi API (nh∆∞ searchScholarships v√† getScholarshipById).4. H∆∞·ªõng d·∫´n T√≠ch h·ª£p (Step-by-Step)File c·∫ßn ch·ªânh s·ª≠a: src/services/scholarship.service.tsB∆∞·ªõc 1: Th√™m h√†m _transformOpportunity (H√†m Phi√™n D·ªãch)ƒê·∫ßu ti√™n, h√£y th√™m h√†m private n√†y v√†o b√™n trong class ScholarshipService. H√†m n√†y s·∫Ω nh·∫≠n d·ªØ li·ªáu th√¥ t·ª´ API (item: any) v√† tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c chu·∫©n h√≥a theo types/index.ts.TypeScript// src/services/scholarship.service.ts

import { scholarshipApi } from '@/lib/api';
// 1. Import Scholarship type ƒë·ªÉ ƒë·∫£m b·∫£o ki·ªÉu tr·∫£ v·ªÅ ch√≠nh x√°c
import { Scholarship, ScholarshipSearchResponse, ScholarshipSearchParams } from '@/types';

class ScholarshipService {

    /**
     * H√ÄM M·ªöI: H√†m "phi√™n d·ªãch" private
     * D·ªãch d·ªØ li·ªáu th√¥ t·ª´ API (Backend) sang c·∫•u tr√∫c d·ªØ li·ªáu c·ªßa Frontend (types/index.ts)
     */
    private _transformOpportunity(item: any): Scholarship {
        
        // X·ª≠ l√Ω logic cho studyMode -> isRemote
        const isRemote = (item.studyMode === 'REMOTE' || item.studyMode === 'ONLINE');

        return {
            ...item, // Gi·ªØ l·∫°i c√°c tr∆∞·ªùng kh√¥ng m√¢u thu·∫´n (nh∆∞ title, location...)
            
            // --- B·∫ÆT ƒê·∫¶U PHI√äN D·ªäCH ---
            
            // ƒê·∫£m b·∫£o ID lu√¥n l√† string
            id: String(item.id),

            // 1. D·ªãch Amount
            // (Backend: scholarshipAmount, Frontend: amount)
            amount: item.scholarshipAmount || item.amount || 0,
            
            // 2. D·ªãch Status
            // (Backend: moderationStatus, Frontend: status)
            status: item.moderationStatus || item.status,
            
            // 3. D·ªãch Level
            // (Backend: level, Frontend: type)
            type: item.level || item.type,
            
            // 4. D·ªãch StudyMode
            // (Backend: studyMode, Frontend: isRemote)
            isRemote: isRemote,
            studyMode: item.studyMode, // (V·∫´n gi·ªØ studyMode n·∫øu component n√†o ƒë√≥ c·∫ßn)

            // 5. D·ªãch Description
            // (Backend: fullDescription, Frontend: description)
            description: item.fullDescription || item.description,
            
            // 6. D·ªãch Provider ID
            // (Backend: creatorUserId, Frontend: providerId)
            providerId: String(item.creatorUserId || item.providerId),

            // 7. D·ªãch View Count
            // (Backend: viewsCnt, Frontend: viewCount)
            viewCount: item.viewsCnt || item.viewCount || 0,

            // 8. D·ªãch Duration
            // (Backend: durationMonths, Frontend: duration)
            duration: item.durationMonths || item.duration || 0,

            // --- K·∫æT TH√öC PHI√äN D·ªäCH ---
            
            // ƒê·∫£m b·∫£o c√°c tr∆∞·ªùng lu√¥n t·ªìn t·∫°i (tr√°nh l·ªói undefined)
            providerName: item.providerName || `Organization #${item.organizationId}`,
            requirements: item.requirements || {},
            requiredSkills: item.requiredSkills || [],
            preferredSkills: item.preferredSkills || [],
            tags: item.tags || [],
            createdAt: new Date(item.createdAt), // Chuy·ªÉn sang Date object
        };
    }

    // ... (C√°c h√†m kh√°c) ...
}

export const scholarshipService = new ScholarshipService();

B∆∞·ªõc 2: S·ª≠ d·ª•ng h√†m _transformOpportunity trong searchScholarshipsB√¢y gi·ªù, h√£y c·∫≠p nh·∫≠t h√†m searchScholarships c·ªßa b·∫°n ƒë·ªÉ s·ª≠ d·ª•ng h√†m phi√™n d·ªãch n√†y.TypeScript// src/services/scholarship.service.ts (b√™n trong class ScholarshipService)

  /**
   * T√¨m ki·∫øm h·ªçc b·ªïng v·ªõi c√°c tham s·ªë filter/sort
   */
  async searchScholarships(params: ScholarshipSearchParams = {}): Promise<ScholarshipSearchResponse> {
    try {
      // ... (Ph·∫ßn code g·ªçi API gi·ªØ nguy√™n) ...
      
      console.log('‚úÖ [ScholarshipService] Found scholarships:', response.data.content.length);
      
      // S·ª¨A ƒê·ªîI ·ªû ƒê√ÇY:
      const transformed = {
        ...response.data,
        // Ch·ªâ c·∫ßn g·ªçi h√†m _transformOpportunity cho m·ªói item
        content: response.data.content.map(this._transformOpportunity)
      };
      
      return transformed;
    } catch (error: any) {
      // ... (Ph·∫ßn code catch l·ªói gi·ªØ nguy√™n) ...
    }
  }
B∆∞·ªõc 3: S·ª≠ d·ª•ng h√†m _transformOpportunity trong getScholarshipByIdB·∫°n c≈©ng ph·∫£i l√†m ƒëi·ªÅu t∆∞∆°ng t·ª± cho trang chi ti·∫øt h·ªçc b·ªïng, n·∫øu kh√¥ng trang ƒë√≥ c≈©ng s·∫Ω b·ªã l·ªói.TypeScript// src/services/scholarship.service.ts (b√™n trong class ScholarshipService)

  /**
   * L·∫•y chi ti·∫øt 1 h·ªçc b·ªïng theo ID
   */
  async getScholarshipById(id: string): Promise<Scholarship> {
    try {
      console.log('üîç [ScholarshipService] Fetching scholarship:', id);
      const response = await scholarshipApi.get<any>(`/${id}`); // D√πng <any> ƒë·ªÉ nh·∫≠n d·ªØ li·ªáu th√¥
      console.log('‚úÖ [ScholarshipService] Fetched scholarship:', response.data.title);
      
      // S·ª¨A ƒê·ªîI ·ªû ƒê√ÇY:
      // D·ªãch d·ªØ li·ªáu th√¥ tr∆∞·ªõc khi tr·∫£ v·ªÅ
      return this._transformOpportunity(response.data);

    } catch (error: any) {
      console.error('‚ùå [ScholarshipService] Failed to fetch scholarship:', error);
      throw error;
    }
  }

// ... (C√°c h√†m kh√°c gi·ªØ nguy√™n)
5. K·∫øt qu·∫£Sau khi ho√†n th√†nh 3 b∆∞·ªõc tr√™n v√† ch·ªâ s·ª≠a duy nh·∫•t file src/services/scholarship.service.ts:Backend (scholarship-service): ƒê∆∞·ª£c gi·ªØ nguy√™n. API ·ªïn ƒë·ªãnh.Frontend Components (React): Gi·ªØ nguy√™n. C√°c file nh∆∞ ScholarshipCard.tsx v√† [id]/page.tsx/page.tsx] s·∫Ω nh·∫≠n ƒë∆∞·ª£c ƒë√∫ng d·ªØ li·ªáu ch√∫ng mong ƒë·ª£i (amount, type, status, isRemote) v√† hi·ªÉn th·ªã ch√≠nh x√°c.L·ªõp Service (Adapter): M·ªçi logic "d·ªãch" d·ªØ li·ªáu l·ªôn x·ªôn ƒë·ªÅu ƒë∆∞·ª£c gom v·ªÅ m·ªôt n∆°i duy nh·∫•t, gi√∫p code d·ªÖ b·∫£o tr√¨.6. B·∫£ng tra c·ª©u API (Tham kh·∫£o)Lu·ªìng t√≠ch h·ª£p n√†y s·∫Ω d·ª±a tr√™n c√°c API sau t·ª´ scholarship-service:T√≠nh nƒÉng FEMethodEndpoint (Sau Nginx)Controller (Backend)DTO (Backend)T√¨m ki·∫øm/L·ªçc (Trang List)GET/api/scholarshipsScholarshipPublicController.javaPage<OpportunityDto>Xem Chi ti·∫øtGET/api/scholarships/{id}ScholarshipPublicController.javaOpportunityDetailDtoN·ªôp ƒë∆°nPOST/api/applicationsApplicationController.javaCreateApplicationRequestL∆∞u/B·ªè l∆∞u (Bookmark)POST/api/bookmarks/{id}BookmarkController.java